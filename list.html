<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>æœƒå“¡åˆ—è¡¨</title>
</head>
<body>
  <h2>æœƒå“¡åˆ—è¡¨</h2>
  <div id="memberList"></div>
  <div id="pagination"></div>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbyal9T_4CJoMVgVUuxgaCBSmFETKSa_hVNngpeUwsWxzZ9p1n9I1yJwa-qtLcB1RHPPTg/exec"; // æ›¿æ›æˆä½ çš„ GAS Web App URL
    const pageSize = 10;
    let currentPage = 1;
    let members = [];

    async function fetchMembers() {
      try {
        const resp = await fetch(GAS_URL, {
          method: "POST",
          body: JSON.stringify({ action:"getList" }),
          headers: { "Content-Type": "application/json" }
        });
        members = await resp.json();
        renderPage(currentPage);
      } catch(err) {
        document.getElementById("memberList").textContent = "è³‡æ–™è¼‰å…¥å¤±æ•—ï¼š" + err.message;
      }
    }

    function renderPage(page) {
      const listDiv = document.getElementById("memberList");
      listDiv.innerHTML = "";

      const start = (page - 1) * pageSize;
      const end = start + pageSize;
      const pageItems = members.slice(start, end);

      pageItems.forEach(member => {
        const div = document.createElement("div");
        // ğŸ”¹ æ¯å€‹æœƒå“¡è³‡æ–™æ”¾å…¥ divï¼Œå¯è‡ªè¡Œ RWD èª¿æ•´
        div.innerHTML = `
          <div>
            <div>å§“å: ${member["å§“å"]}</div>
            <div>ç”Ÿæ—¥: ${member["ç”Ÿæ—¥"]}</div>
            <div>æœå‹™å–®ä½: ${member["æœå‹™å–®ä½"]}</div>
            <div>è¡Œå‹•é›»è©±: ${member["è¡Œå‹•é›»è©±-å¸³"]}</div>
            <div>é€šè¨Šåœ°å€: ${member["é€šè¨Šåœ°å€"]}</div>
            <div>E-mail: ${member["E-mail"]}</div>
            <div>LINE: ${member["LINE"]}</div>
          </div>
          <hr>
        `;
        listDiv.appendChild(div);
      });

      renderPagination();
    }

    function renderPagination() {
      const pageCount = Math.ceil(members.length / pageSize);
      const pagDiv = document.getElementById("pagination");
      pagDiv.innerHTML = "";

      for (let i = 1; i <= pageCount; i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        if (i === currentPage) btn.disabled = true;
        btn.addEventListener("click", () => {
          currentPage = i;
          renderPage(currentPage);
        });
        pagDiv.appendChild(btn);
      }
    }

    fetchMembers();
  </script>
</body>
</html>
